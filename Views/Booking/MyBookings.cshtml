@model IEnumerable<SporSalonu2.Models.Booking>
@{
    ViewData["Title"] = "Randevularım";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    /* Kullanıcı Paneli Kart Tasarımı */
    .booking-card {
        background-color: #1e272e;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        border: 1px solid rgba(255,255,255,0.05);
        padding: 20px;
    }

    /* Özel Tablo Yapısı */
    .table-modern {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0 12px; /* Satırlar arası boşluk */
        color: #dfe6e9;
    }

        .table-modern thead th {
            color: #00cec9; /* Başlık rengi */
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.85rem;
            padding-bottom: 10px;
            border: none;
        }

        .table-modern tbody tr {
            background-color: #2d3436; /* Satır arka planı */
            transition: all 0.2s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

            .table-modern tbody tr:hover {
                transform: translateY(-2px);
                background-color: #353b48;
                box-shadow: 0 8px 15px rgba(0,0,0,0.2);
            }

        .table-modern td {
            padding: 18px;
            vertical-align: middle;
            border: none;
        }

        /* Satır kenarlarını yuvarlama */
        .table-modern tbody tr td:first-child {
            border-top-left-radius: 12px;
            border-bottom-left-radius: 12px;
        }

        .table-modern tbody tr td:last-child {
            border-top-right-radius: 12px;
            border-bottom-right-radius: 12px;
        }

    /* Avatar Stili */
    .avatar-circle {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, #6c5ce7, #a29bfe);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-right: 12px;
        box-shadow: 0 3px 10px rgba(108, 92, 231, 0.3);
    }

    /* Saat Kutusu */
    .time-capsule {
        background: #2f3542;
        color: #f1c40f;
        padding: 8px 15px;
        border-radius: 20px;
        font-family: 'Courier New', monospace;
        font-weight: bold;
        border: 1px solid #57606f;
        display: inline-block;
    }

    /* Durum Stilleri */
    .status-pill {
        padding: 6px 15px;
        border-radius: 30px;
        font-size: 0.75rem;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .st-approved {
        background: rgba(46, 204, 113, 0.2);
        color: #2ecc71;
        border: 1px solid #2ecc71;
    }

    .st-rejected {
        background: rgba(231, 76, 60, 0.2);
        color: #e74c3c;
        border: 1px solid #e74c3c;
    }

    .st-pending {
        background: rgba(241, 196, 15, 0.2);
        color: #f1c40f;
        border: 1px solid #f1c40f;
    }

    .st-cancelled {
        background: rgba(149, 165, 166, 0.2);
        color: #b2bec3;
        border: 1px solid #b2bec3;
    }

    /* İptal Butonu */
    .btn-cancel-modern {
        color: #ff7675;
        border: 1px solid #ff7675;
        background: transparent;
        padding: 6px 15px;
        border-radius: 8px;
        font-size: 0.85rem;
        font-weight: 600;
        transition: 0.2s;
    }

        .btn-cancel-modern:hover {
            background: #ff7675;
            color: white;
            text-decoration: none;
        }

    .btn-new-booking {
        background: linear-gradient(135deg, #00b894, #00cec9);
        color: white;
        padding: 10px 25px;
        border-radius: 30px;
        font-weight: bold;
        text-decoration: none;
        box-shadow: 0 4px 15px rgba(0, 184, 148, 0.4);
        transition: 0.2s;
    }

        .btn-new-booking:hover {
            transform: translateY(-2px);
            color: white;
        }
</style>

<div class="container" style="margin-top: 100px; margin-bottom: 80px;">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-white fw-bold"><i class="fas fa-calendar-alt me-2 text-warning"></i>Randevularım</h2>
        <a asp-action="Index" class="btn-new-booking">+ YENİ RANDEVU AL</a>
    </div>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success border-0 shadow-sm">@TempData["Success"]</div>
    }
    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger border-0 shadow-sm">@TempData["Error"]</div>
    }

    <div class="booking-card">
        <div class="table-responsive">
            <table class="table-modern">
                <thead>
                    <tr>
                        <th>Hizmet (Branş)</th>
                        <th>Antrenör</th>
                        <th>Tarih</th>
                        <th>Saat</th>
                        <th>Durum</th>
                        <th class="text-end">İşlemler</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null && Model.Any())
                    {
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td class="fw-bold text-white">@item.Service?.Name</td>

                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="avatar-circle">
                                            @(item.Trainer?.FirstName?.Substring(0, 1) ?? "-")
                                        </div>
                                        <span class="fw-bold text-light">@item.Trainer?.FirstName @item.Trainer?.LastName</span>
                                    </div>
                                </td>

                                <td class="text-muted">@item.AppointmentDate.ToString("dd.MM.yyyy")</td>

                                <td>
                                    <span class="time-capsule">
                                        <i class="far fa-clock me-1"></i> @item.AppointmentTime
                                    </span>
                                </td>

                                <td>
                                    @if (item.Status == SporSalonu2.Models.BookingStatus.Approved)
                                    {
                                        <span class="status-pill st-approved">Onaylandı</span>
                                    }
                                    else if (item.Status == SporSalonu2.Models.BookingStatus.Rejected)
                                    {

                                        <span class="status-pill st-rejected">Reddedildi</span>
                                    }
                                    else if (item.Status == SporSalonu2.Models.BookingStatus.Pending)
                                    {

                                        <span class="status-pill st-pending">Bekliyor</span>
                                    }
                                    else
                                    {

                                        <span class="status-pill st-cancelled">İptal Edildi</span>
                                    }
                                </td>

                                <td class="text-end">
                                    @if (item.Status == SporSalonu2.Models.BookingStatus.Pending || item.Status == SporSalonu2.Models.BookingStatus.Approved)
                                    {
                                        <form asp-action="Cancel" method="post" style="display:inline;" onsubmit="return confirm('Bu randevuyu iptal etmek istediğinize emin misiniz?');">
                                            <input type="hidden" name="id" value="@item.Id" />
                                            <button type="submit" class="btn-cancel-modern">
                                                <i class="fas fa-times me-1"></i> İptal Et
                                            </button>
                                        </form>
                                    }
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="6" class="text-center py-5 text-muted">
                                <i class="fas fa-calendar-times fa-3x mb-3"></i><br>
                                Henüz aktif bir randevunuz bulunmamaktadır.
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>