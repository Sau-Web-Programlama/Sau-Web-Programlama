@model SporSalonu2.Models.TrainerViewModel
@{
    ViewData["Title"] = "Antrenörü Düzenle";
    // Controller'dan gelen seçili günleri alıyoruz
    var selectedDays = ViewBag.SelectedDays as List<string> ?? new List<string>();
}

<div class="auth-container">
    <div class="auth-box" style="max-width: 600px;">
        <h2>✏️ Antrenörü Düzenle</h2>

        <form method="post" asp-controller="Admin" asp-action="EditTrainer">
            <input type="hidden" asp-for="Id" />
            <div asp-validation-summary="ModelOnly" style="color: red; margin-bottom: 1rem;"></div>

            <div class="form-group">
                <label asp-for="FirstName">Ad *</label>
                <input asp-for="FirstName" required />
                <span asp-validation-for="FirstName" style="color:red"></span>
            </div>

            <div class="form-group">
                <label asp-for="LastName">Soyad *</label>
                <input asp-for="LastName" required />
                <span asp-validation-for="LastName" style="color:red"></span>
            </div>

            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label style="font-weight: bold; margin-bottom: 0.8rem; display: block; color: #ecf0f1;">
                    Uzmanlık Alanları <span style="color:#e74c3c">*</span>
                </label>

                <div class="specialty-wrapper">
                    @for (int i = 0; i < Model.AvailableServices.Count; i++)
                    {
                        var item = Model.AvailableServices[i];
                        string emoji = "⭐";
                        if (item.Name.Contains("Fitness")) emoji = "💪";
                        else if (item.Name.Contains("Yoga")) emoji = "🧘";
                        else if (item.Name.Contains("Pilates")) emoji = "🤸";
                        else if (item.Name.Contains("Gym")) emoji = "🏋️";

                        bool isChecked = Model.SelectedServiceIds.Contains(item.Id);

                        <input type="checkbox"
                               class="btn-check"
                               name="SelectedServiceIds"
                               value="@item.Id"
                               id="srv_@item.Id"
                               @(isChecked ? "checked" : "")
                               autocomplete="off">

                        <label class="specialty-tag" for="srv_@item.Id">
                            <span class="emoji-span">@emoji</span> @item.Name
                        </label>
                    }
                </div>
            </div>

            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label style="font-weight: bold; margin-bottom: 0.8rem; display: block; color: #ecf0f1;">
                    Çalışma Günleri
                </label>

                <div class="specialty-wrapper">
                    @{
                        // Günlerin listesi ve Türkçe karşılıkları
                        var days = new Dictionary<string, string>
                                        {
                                        {"Monday", "Pazartesi"}, {"Tuesday", "Salı"}, {"Wednesday", "Çarşamba"},
                                        {"Thursday", "Perşembe"}, {"Friday", "Cuma"}, {"Saturday", "Cumartesi"}, {"Sunday", "Pazar"}
                                        };
                    }

                    @foreach (var day in days)
                    {
                        // Eğer bu gün veritabanındaki listede varsa kutucuğu işaretle (checked)
                        bool isDaySelected = selectedDays.Contains(day.Key);

                        <input type="checkbox"
                               class="btn-check"
                               name="selectedDays"
                               value="@day.Key"
                               id="day_@day.Key"
                               @(isDaySelected ? "checked" : "")
                               autocomplete="off">

                        <label class="specialty-tag" for="day_@day.Key">📅 @day.Value</label>
                    }
                </div>
                <small class="text-muted" style="display:block; margin-top:8px; color: #bdc3c7 !important;">
                    Mevcut çalışma günlerini değiştirebilirsiniz.
                </small>
            </div>

            <div class="form-group">
                <label asp-for="Email">E-posta</label>
                <input asp-for="Email" required />
            </div>

            <div class="form-group">
                <label asp-for="Phone">Telefon</label>
                <input asp-for="Phone" />
            </div>

            <div class="form-group">
                <label asp-for="Bio">Biyografi</label>
                <textarea asp-for="Bio" rows="4"></textarea>
            </div>

            <button type="submit" class="btn btn-warning" style="width: 100%; padding: 1rem; font-weight:bold;">
                💾 Değişiklikleri Kaydet
            </button>

            <a asp-action="Trainers" class="btn btn-outline-light mt-3" style="width: 100%;">İptal</a>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <style>
        /* Create sayfasındaki stilin aynısı */
        .specialty-wrapper {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            padding: 5px 0;
        }

        .btn-check {
            position: absolute;
            clip: rect(0,0,0,0);
            pointer-events: none;
        }

        .specialty-tag {
            display: inline-flex;
            align-items: center;
            padding: 10px 18px;
            background-color: #2c3e50;
            border: 1px solid #4a5568;
            border-radius: 8px;
            color: #e2e8f0;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }

            .specialty-tag:hover {
                background-color: #34495e;
                border-color: #718096;
            }

        .btn-check:checked + .specialty-tag {
            background-color: #f39c12; /* Düzenleme olduğu için turuncu/sarı ton */
            border-color: #f39c12;
            color: #2c3e50;
            font-weight: bold;
            transform: translateY(-2px);
            box-shadow: 0 0 10px rgba(243, 156, 18, 0.4);
        }

        .emoji-span {
            margin-right: 8px;
            font-size: 1.1rem;
        }
    </style>
}