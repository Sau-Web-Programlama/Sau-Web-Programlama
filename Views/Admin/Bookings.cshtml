@* Views/Admin/Bookings.cshtml *@
@using SporSalonu2.Models
@model List<Booking>
@{
    ViewData["Title"] = "Randevu Yönetimi";
    var pendingBookings = Model.Where(b => b.Status == BookingStatus.Pending).ToList();
    var approvedBookings = Model.Where(b => b.Status == BookingStatus.Approved).ToList();
}

<div class="container page-container">
    <h2 class="section-title">📅 Randevu Yönetimi</h2>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success">@TempData["Success"]</div>
    }

    <h4 style="color: var(--accent-orange); margin-top: 2rem; margin-bottom: 1.5rem;">Bekleyen Onaylar (@pendingBookings.Count)</h4>

    <table class="admin-table">
        <thead>
            <tr>
                <th>Randevu ID</th>
                <th>Üye E-posta</th>
                <th>Hizmet</th>
                <th>Antrenör</th>
                <th>Tarih/Saat</th>
                <th>İşlemler</th>
            </tr>
        </thead>
        <tbody>
            @if (pendingBookings.Any())
            {
                @foreach (var item in pendingBookings)
                {
                    <tr>
                        <td>#@item.Id</td>
                        <td>@item.MemberId</td>
                        <td>@item.Service.Name</td>
                        <td>@item.Trainer.FirstName @item.Trainer.LastName</td>
                        <td>@item.AppointmentDate.ToShortDateString() / @item.AppointmentTime</td>
                        <td>
                            <form method="post" asp-controller="Admin" asp-action="ApproveBooking" asp-route-id="@item.Id" style="display: inline;">
                                <button type="submit" class="btn btn-primary" style="padding: 0.3rem 0.6rem;">Onayla</button>
                            </form>
                            <form method="post" asp-controller="Admin" asp-action="RejectBooking" asp-route-id="@item.Id" style="display: inline;">
                                <button type="submit" class="btn btn-outline" style="padding: 0.3rem 0.6rem;">Reddet</button>
                            </form>
                        </td>
                    </tr>
                }
            }
            else
            {
                <tr><td colspan="6" style="text-align: center;">Bekleyen randevu onayı bulunmamaktadır.</td></tr>
            }
        </tbody>
    </table>

    <h4 style="color: var(--accent-green); margin-top: 3rem; margin-bottom: 1.5rem;">Onaylananlar (@approvedBookings.Count)</h4>

    <table class="admin-table">
        <thead>
            <tr>
                <th>Randevu ID</th>
                <th>Üye E-posta</th>
                <th>Hizmet</th>
                <th>Antrenör</th>
                <th>Tarih/Saat</th>
                <th>Durum</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in approvedBookings)
            {
                <tr>
                    <td>#@item.Id</td>
                    <td>@item.MemberId</td>
                    <td>@item.Service.Name</td>
                    <td>@item.Trainer.FirstName @item.Trainer.LastName</td>
                    <td>@item.AppointmentDate.ToShortDateString() / @item.AppointmentTime</td>
                    <td style="color: var(--accent-green);">Onaylandı</td>
                </tr>
            }
        </tbody>
    </table>
</div>